import{_ as d}from"./ValaxyMain.vue_vue_type_style_index_0_lang.lRv1foRR.js";import"./chunks/@vueuse/motion.Dg1YJU_6.js";import{e as g,u as c,a as y}from"./chunks/vue-router.F0_SMo9a.js";import{aa as u,ap as l,ag as t,af as s,ai as i,F,ab as m,Z as C}from"./framework.BXuQlAZZ.js";import"./app.BpXY-T98.js";import"./chunks/dayjs.BdcnXKr1.js";import"./chunks/vue-i18n.VKblUafi.js";import"./chunks/pinia.B9A8EvoY.js";/* empty css                    */import"./chunks/nprogress.B6x19dEb.js";import"./YunComment.vue_vue_type_style_index_0_lang.IbJE91nT.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.Drtr8QDt.js";import"./post.D73PSk4d.js";const B=g("/posts/event-loop",async n=>JSON.parse('{"title":"关于事件循环","description":"","frontmatter":{"layout":"post","title":"关于事件循环","date":"2025-08-15","updated":"2025-08-25","categories":["技术"],"tags":["事件循环"]},"headers":[],"relativePath":"pages/posts/event-loop.md","lastUpdated":1761888038000}'),{lazy:(n,h)=>n.name===h.name}),J={__name:"event-loop",setup(n,{expose:h}){const{data:k}=B(),r=y(),p=c(),e=Object.assign(p.meta.frontmatter||{},k.value?.frontmatter||{});return r.currentRoute.value.data=k.value,C("valaxy:frontmatter",e),globalThis.$frontmatter=e,h({frontmatter:{layout:"post",title:"关于事件循环",date:"2025-08-15",updated:"2025-08-25",categories:["技术"],tags:["事件循环"]}}),(a,E)=>{const o=d;return m(),u(o,{frontmatter:F(e)},{"main-content-md":l(()=>[...E[0]||(E[0]=[s("h3",{id:"前言",tabindex:"-1"},[i("前言 "),s("a",{class:"header-anchor",href:"#前言","aria-label":'Permalink to "前言"'},"​")],-1),s("p",null,"关于这个事件循环，最初在慧策笔试的时候碰到过，美团一面的时候也被拷打过，面试官建议我再多去了解一下，所以写这篇文章加深一下对事件循环的理解",-1),s("h3",{id:"事件循环概念",tabindex:"-1"},[i("事件循环概念 "),s("a",{class:"header-anchor",href:"#事件循环概念","aria-label":'Permalink to "事件循环概念"'},"​")],-1),s("p",null,"事件循环（Event Loop）是 JavaScript 运行时的核心机制，用于处理异步操作、用户交互等事件，保证代码按顺序执行。 JavaScript 是单线程语言，意味着同一时间只能执行一个任务。为了处理异步操作（如网络请求、定时器等）， JavaScript 引入了事件循环机制。事件循环负责执行代码、收集和处理事件以及执行队列中的子任务。",-1),s("h3",{id:"工作原理",tabindex:"-1"},[i("工作原理 "),s("a",{class:"header-anchor",href:"#工作原理","aria-label":'Permalink to "工作原理"'},"​")],-1),s("p",null,"JavaScript 运行时主要包含以下几个部分：",-1),s("ul",null,[s("li",null,"调用栈（Call Stack）：用于执行同步代码，遵循后进先出（LIFO）原则。当函数被调用时，会在调用栈中创建一个新的栈帧，函数执行完毕后，栈帧出栈。"),s("li",null,"任务队列（Task Queue）：存放异步操作完成后待执行的回调函数。任务队列又分为宏任务队列（MacroTask Queue）和微任务队列（MicroTask Queue）。"),s("li",null,"事件循环（Event Loop）：持续检查调用栈是否为空，若为空，则从任务队列中取出任务放入调用栈执行。")],-1),s("p",null,"事件循环的工作流程如下：",-1),s("ul",null,[s("li",null,"检查调用栈是否为空，如果不为空，执行调用栈中的任务。"),s("li",null,"若调用栈为空，检查微任务队列是否有任务，若有则依次执行，直到微任务队列为空。"),s("li",null,"微任务队列清空后，从宏任务队列中取出一个任务放入调用栈执行，执行完成后，重复步骤 2 和 3。")],-1),s("h3",{id:"宏任务与微任务",tabindex:"-1"},[i("宏任务与微任务 "),s("a",{class:"header-anchor",href:"#宏任务与微任务","aria-label":'Permalink to "宏任务与微任务"'},"​")],-1),s("ul",null,[s("li",null,"宏任务（MacroTask）：常见的宏任务有 setTimeout、setInterval、setImmediate（Node.js）、requestAnimationFrame（浏览器）、I/O 操作、UI 渲染等。"),s("li",null,"微任务（MicroTask）：常见的微任务有 Promise.then、async/await（本质上是基于 Promise）、MutationObserver（浏览器）、process.nextTick（Node.js）等。")],-1),s("h3",{id:"输出代码题练习",tabindex:"-1"},[i("输出代码题练习 "),s("a",{class:"header-anchor",href:"#输出代码题练习","aria-label":'Permalink to "输出代码题练习"'},"​")],-1),s("p",null,"最简单的：",-1),s("div",{class:"language-js max-h-300px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"js"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'script start'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setTimeout"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'setTimeout'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}, "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Promise"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"resolve"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"then"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'promise1'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  })")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"then"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'promise2'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  });")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'script end'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("details",{class:"details custom-block"},[s("summary",null,"点击查看输出顺序"),s("p",null,"script start"),s("p",null,"script end"),s("p",null,"promise1"),s("p",null,"promise2"),s("p",null,"setTimeout")],-1),s("p",null,"执行过程：",-1),s("ol",null,[s("li",null,[i("执行全局代码，将 "),s("code",null,"console.log('script start')"),i(" 压入调用栈，执行完毕后出栈。")]),s("li",null,[i("遇到 "),s("code",null,"setTimeout"),i(" 定时器，将其回调函数压入宏任务队列。")]),s("li",null,[i("遇到 "),s("code",null,"Promise.resolve()"),i("，将其回调函数压入微任务队列。")]),s("li",null,[i("执行 "),s("code",null,"console.log('script end')"),i("，将其压入调用栈，执行完毕后出栈。")]),s("li",null,[i("调用栈为空，检查微任务队列，发现有 "),s("code",null,"Promise.then"),i(" 回调函数，将其压入调用栈，执行完毕后出栈。")]),s("li",null,[i("再次检查微任务队列，发现还有 "),s("code",null,"Promise.then"),i(" 回调函数，将其压入调用栈，执行完毕后出栈。")]),s("li",null,[i("微任务队列清空，从宏任务队列中取出 "),s("code",null,"setTimeout"),i(" 回调函数，将其压入调用栈，执行完毕后出栈。")]),s("li",null,"调用栈为空，事件循环结束。")],-1),s("div",{class:"language-js max-h-300px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"js"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"async"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," function"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," async1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'async1 start'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  await"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Promise"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"resolve"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'promise1'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    setTimeout"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      resolve"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'setTimeout1'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }, "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  });")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'async1 end'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"async"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," function"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," async2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'async2 start'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  await"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Promise"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"resolve"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    setTimeout"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"      resolve"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'setTimeout2'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }, "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  });")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'async2 end'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'script start'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"async1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"async2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Promise"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"resolve"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'promise2'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  resolve"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"})."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"then"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'promise3'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"});")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'script end'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("details",{class:"details custom-block"},[s("summary",null,"点击查看输出顺序"),s("p",null,"script start"),s("p",null,"async1 start"),s("p",null,"promise1"),s("p",null,"async1 end"),s("p",null,"setTimeout1"),s("p",null,"async2 start"),s("p",null,"async2 end"),s("p",null,"setTimeout2"),s("p",null,"promise2"),s("p",null,"script end"),s("p",null,"promise3")],-1),s("p",null,"执行过程：",-1),s("ol",null,[s("li",null,[i("执行全局代码，将 "),s("code",null,"console.log('script start')"),i(" 压入调用栈，执行完毕后出栈。")]),s("li",null,[i("遇到 "),s("code",null,"async1"),i(" 函数，将其压入调用栈，执行 async1 函数内部代码。")]),s("li",null,[i("执行 "),s("code",null,"console.log('async1 start')"),i("，将其压入调用栈，执行完毕后出栈。")]),s("li",null,[i("遇到 "),s("code",null,"await"),i(" 关键字，将 "),s("code",null,"await"),i(" 后面的 "),s("code",null,"Promise"),i(" 压入微任务队列，将 "),s("code",null,"async1"),i(" 函数的剩余代码压入调用栈。")]),s("li",null,[i("执行 "),s("code",null,"console.log('promise1')"),i("，将其压入调用栈，执行完毕后出栈。")]),s("li",null,[i("遇到 "),s("code",null,"setTimeout"),i(" 定时器，将其回调函数压入宏任务队列。")]),s("li",null,[i("执行 "),s("code",null,"console.log('async1 end')"),i("，将其压入调用栈，执行完毕后出栈。")]),s("li",null,[i("调用栈为空，检查微任务队列，发现有 "),s("code",null,"Promise.then"),i(" 回调函数，将其压入调用栈，执行完毕后出栈。")]),s("li",null,[i("再次检查微任务队列，为空，从宏任务队列中取出 "),s("code",null,"setTimeout"),i(" 回调函数，将其压入调用栈，执行完毕后出栈。")]),s("li",null,"调用栈为空，事件循环结束。")],-1),s("p",null,[i("如果没有 "),s("code",null,"await"),i(" 关键字的话，输出顺序如下")],-1),s("details",{class:"details custom-block"},[s("summary",null,"点击查看输出顺序"),s("p",null,"script start"),s("p",null,"async1 start"),s("p",null,"promise1"),s("p",null,"async1 end"),s("p",null,"async2 start"),s("p",null,"async2 end"),s("p",null,"promise2"),s("p",null,"script end"),s("p",null,"promise3"),s("p",null,"setTimeout1"),s("p",null,"setTimeout2")],-1),s("p",null,[s("strong",null,"await 的作用"),i("： 由于await会暂停当前async函数，将后续的代码包装成微任务，只有当promise改变状态（promise完成后），才会恢复执行")],-1),s("div",{class:"language-js max-h-300px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"js"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"🚀 开始"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Promise"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"resolve"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"then"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"1️⃣ 第一个.then"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"then"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"2️⃣ 第二个.then"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Promise"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"resolve"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"then"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," console."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"3️⃣ 外部.then"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("details",{class:"details custom-block"},[s("summary",null,"点击查看输出顺序"),s("div",{class:"language-text max-h-300px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"text"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"🚀 开始")]),i(`
`),s("span",{class:"line"},[s("span",null,"1️⃣ 第一个.then")]),i(`
`),s("span",{class:"line"},[s("span",null,"3️⃣ 外部.then")]),i(`
`),s("span",{class:"line"},[s("span",null,"2️⃣ 第二个.then")])])]),s("button",{class:"code-block-unfold-btn"})])],-1),s("p",null,"这题是我之前做错的，我当时误以为第二个then会在外部then之前执行，但是实际上是在外部then之后执行的。正确理解是每个.then只有在前一个Promise解决后才会注册",-1),s("h3",{id:"相关资料",tabindex:"-1"},[i("相关资料 "),s("a",{class:"header-anchor",href:"#相关资料","aria-label":'Permalink to "相关资料"'},"​")],-1),s("p",null,[s("a",{href:"https://www.ruanyifeng.com/blog/2014/10/event-loop.html",target:"_blank",rel:"noreferrer"},"https://www.ruanyifeng.com/blog/2014/10/event-loop.html")],-1),s("p",null,[s("a",{href:"https://segmentfault.com/a/1190000046362554",target:"_blank",rel:"noreferrer"},"https://segmentfault.com/a/1190000046362554")],-1),s("p",null,[s("a",{href:"https://zhuanlan.zhihu.com/p/33058983",target:"_blank",rel:"noreferrer"},"https://zhuanlan.zhihu.com/p/33058983")],-1),s("p",null,[s("a",{href:"https://juejin.cn/post/6844904079353708557?searchId=20250815220628C3C5642C55BE65D2B440#heading-0",target:"_blank",rel:"noreferrer"},"https://juejin.cn/post/6844904079353708557?searchId=20250815220628C3C5642C55BE65D2B440#heading-0")],-1)])]),"main-header":l(()=>[t(a.$slots,"main-header")]),"main-header-after":l(()=>[t(a.$slots,"main-header-after")]),"main-nav":l(()=>[t(a.$slots,"main-nav")]),"main-content-before":l(()=>[t(a.$slots,"main-content-before")]),"main-content":l(()=>[t(a.$slots,"main-content")]),"main-content-after":l(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":l(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":l(()=>[t(a.$slots,"main-nav-after")]),comment:l(()=>[t(a.$slots,"comment")]),footer:l(()=>[t(a.$slots,"footer")]),aside:l(()=>[t(a.$slots,"aside")]),"aside-custom":l(()=>[t(a.$slots,"aside-custom")]),default:l(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter"])}}};export{J as default,B as usePageData};
